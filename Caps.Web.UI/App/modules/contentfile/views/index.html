<div id="files-index" class="app-page bottom-fixed-navbar-container">
    
    <div id="drop-zone" data-bind="click: resetSelectedItem">

        <div class="row thumbnails-fixed-size list-files" data-bind="lazyLoad: { pageSize: itemsPerPage(), loadHandler: loadHandler, data: listItems }, scrollTop: { observable: scrollTop, enabled: isInteractive }">
            <div class="col-sm-6 col-md-3">
                <div class="thumbnail-container">
                    <a href="#" class="thumbnail" data-bind="css: { 'item-checked': isSelected, 'item-selected': isSelectedItem }, click: selectItem, clickBubble: false, event: { dblclick: $parent.showDetail }">
                        <!-- ko if: data() && data().isImage -->
                        <img src="/content/images/blank.gif" data-bind="attr: { 'data-src': '/DbFileContent/Thumbnail/' + data().Id() + '?thumbnailName=220x160' }" alt="..." class="lazy img-responsive" />
                        <!-- /ko -->
                    </a>
                    <!-- ko if: data() -->          
                        <div class="item-check" data-bind="click: toggleSelected, clickBubble: false, attr: { title: data().FileName() + ' auswählen' }">
                            <i data-bind="css: { 'icon-check': isSelected, 'icon-check-empty': !isSelected() }"></i>
                        </div>          
                        <div class="thumbnail-controls">
                            <a class="btn-link pull-right" data-bind="click: $parent.showDetail, clickBubble: false" title="Details anzeigen"><i class="icon-arrow-right icon-2x"></i></a>
                            <a class="btn-link" data-bind="click: $parent.deleteFile, clickBubble: false, attr: { title: data().FileName() + ' löschen' }"><i class="icon-trash icon-2x"></i></a>
                        </div>
                    <!-- /ko -->
                </div>
            </div>
        </div>


        <div class="drop-zone-placeholder" data-bind="visible: listItems().length == 0 && !isLoading()">
            <p data-bind="if: (window.FileReader && Modernizr.draganddrop)">
                <!-- ko if: (window.FileReader && Modernizr.draganddrop) -->
                Füge Dateien hinzu, indem Du sie hier per Drag and Drop ablegst oder unten auf "Dateien hinzufügen" klickst.
                <!-- /ko -->
                <!-- ko if: !(window.FileReader && Modernizr.draganddrop) -->
                Füge Dateien hinzu, indem Du unten auf "Dateien hinzufügen" klickst.
                <!-- /ko -->

            </p>
        </div>
    </div>

    <div class="navbar navbar-default navbar-fixed-bottom">        
        <div class="navbar-panel pull-left">
            <ul class="nav navbar-nav">
                <li>
                    <a class="fileinput-button">
                        <span><i class="icon-fixed-width icon-plus"></i> Dateien hinzufügen</span>
                        <input type="file" name="files" data-url="api/DbFileUpload" data-bind="fileupload: { add: startUpload, done: uploadDone, fail: uploadFailed, progressall: uploadProgress, dropZone: $('#drop-zone'), drop: filesDropped }" multiple>
                    </a>                    
                </li>
                <li>
                    <a href="#" data-bind="click: navigateToSelectedFile, visible: selectedFile()">
                        <i class="icon-arrow-right"></i> Details
                    </a>
                </li>
                <li data-bind="visible: selectedFiles().length > 0">
                    <a href="#" data-bind="click: deleteSelection">
                        <i class="icon-remove"></i> Auswahl löschen
                    </a>
                </li>
            </ul>
        </div>
        
        <div class="navbar-panel pull-right">
            <div class="navbar-text" data-bind="visible: isUploading">
                Upload: <span data-bind="text: progress"></span> %
            </div>

            <div class="navbar-text hidden-sm">
                <!-- ko if: selectedFiles().length > 0 -->
                <span data-bind="text: selectedFiles().length"></span> Dateien ausgewählt
                <!-- /ko -->
                <!-- ko if: selectedFiles().length <= 0 && selectedFile() -->
                <span data-bind="text: selectedFile().data().FileName"></span>
                <!-- /ko -->
            </div>

            <div class="navbar-text">
                <span data-bind="text: searchResult().totalCount"></span> Dateien
            </div>
            <ul class="nav navbar-nav">
                <li>
                    <a href="#" title="Aktualisieren" data-bind="click: refresh"><i class="icon-fixed-width icon-refresh" data-bind="css: { 'icon-spin': isLoading }"></i></a>
                </li>
            </ul>
        </div>
    </div>
</div>