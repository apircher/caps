<div id="files-index" class="app-page bottom-fixed-navbar-container">
    
    <div id="drop-zone" data-bind="click: resetSelectedItem">
        <ul data-bind="foreach: { data: searchResult().items }, infiniteScroll: { distance: 400, container: $(window), loadMoreItems: loadMoreItems, enabled: hasMorePages }" class="thumbnails thumbnails-fixed-size" id="files-list">
            <li class="span3">
                <!-- ko if: data() && !isUploading() -->
                <div class="thumbnail" data-bind="attr: { title: data().FileName }, css: { 'item-checked': isSelected, 'item-selected': isSelectedItem }, click: selectItem, clickBubble: false, event: { dblclick: $parent.showDetail }">                    
                    <!-- ko if: !data().isImage() -->
                    <div class="thumbnail-content preview"><i class="icon-file  center-icon-h icon-4x icon-mood"></i></div>                
                    <!-- /ko -->
                    <!-- ko if: data().isImage -->
                    <div class="thumbnail-content thumbnail-image" data-bind="style: { 'background-image': 'url(/DbFileContent/Thumbnail/' + data().Id() + '?thumbnailName=220x160)' }">
                    </div>                
                    <!-- /ko -->
                    <div class="thumbnail-controls">
                        <a class="btn-link pull-right" data-bind="click: $parent.showDetail, clickBubble: false" title="Details anzeigen"><i class="icon-arrow-right icon-2x"></i></a>
                        <a class="btn-link" data-bind="click: $parent.deleteFile, clickBubble: false, attr: { title: data().FileName() + ' löschen' }"><i class="icon-trash icon-2x"></i></a>
                    </div>
                    <div class="item-check" data-bind="click: toggleSelected, clickBubble: false, attr: { title: data().FileName() + ' auswählen' }">
                        <i data-bind="css: { 'icon-check': isSelected, 'icon-check-empty': !isSelected()}"></i>
                    </div>
                </div>
                <!-- /ko -->
                <!-- ko if: isUploading() -->
                <div class="thumbnail">
                    <div class="thumbnail-content preview">
                        <i class="icon-cog icon-spin icon-4x icon-mood"></i>
                    </div>
                </div>
                <!-- /ko -->
            </li>
        </ul>
        <a href="#" class="btn" data-bind="visible: searchResult().hasMorePages() && !isLoading(), click: loadMoreItems, clickBubble: false">Mehr anzeigen</a>

        <div class="drop-zone-placeholder" data-bind="visible: searchResult().items().length == 0 && !isLoading()">
            <p data-bind="if: (window.FileReader && Modernizr.draganddrop)">
                <!-- ko if: (window.FileReader && Modernizr.draganddrop) -->
                Füge Dateien hinzu, indem Du sie hier per Drag and Drop ablegst oder unten auf "Dateien hinzufügen" klickst.
                <!-- /ko -->
                <!-- ko if: !(window.FileReader && Modernizr.draganddrop) -->
                Füge Dateien hinzu, indem Du unten auf "Dateien hinzufügen" klickst.
                <!-- /ko -->

            </p>
        </div>
    </div>

    <div class="navbar navbar-fixed-bottom">
        <div class="navbar-inner">
            <div class="navbar-panel navbar-text pull-right">
                <span data-bind="text: searchResult().totalCount"></span> Dateien
            </div>
            <ul class="nav pull-right">
                <li>
                    <a href="#" title="Aktualisieren" data-bind="click: refresh"><i class="icon-fixed-width icon-refresh" data-bind="css: { 'icon-spin': isLoading }"></i></a>
                </li>
            </ul>

            <ul class="nav">
                <li>
                    <a class="fileinput-button">
                        <span><i class="icon-plus"></i> Dateien hinzufügen</span>
                        <input type="file" name="files" data-url="api/DbFileUpload" data-bind="fileupload: { add: startUpload, done: uploadDone, fail: uploadFailed, progressall: uploadProgress, dropZone: $('#drop-zone'), drop: filesDropped }" multiple>
                    </a>                    
                </li>
                <li>
                    <a href="#" data-bind="click: navigateToSelectedFile, visible: selectedFile()">
                        <i class="icon-arrow-right"></i> Details
                    </a>
                </li>
                <li data-bind="visible: selectedFiles().length > 0">
                    <a href="#" data-bind="click: deleteSelection">
                        <i class="icon-remove"></i> Auswahl löschen
                    </a>
                </li>
            </ul>

            <div class="navbar-panel navbar-text pull-right hidden-phone">
                <!-- ko if: selectedFiles().length > 0 -->
                <span data-bind="text: selectedFiles().length"></span> Dateien ausgewählt
                <!-- /ko -->
                <!-- ko if: selectedFiles().length <= 0 && selectedFile() -->
                <span data-bind="text: selectedFile().data().FileName"></span>
                <!-- /ko -->
            </div>

            <div class="navbar-panel navbar-text pull-right" data-bind="visible: isUploading">
                Upload: <span data-bind="text: progress"></span> %
            </div>
        </div> 
    </div>
</div>